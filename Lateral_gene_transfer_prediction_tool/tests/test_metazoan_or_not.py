#!/usr/bin/env python
# author: Peter Thorpe October 2019.
# U of St Andrew
# script to test the from HGT_modules.parsenodes import parse_NCBI_nodes_tab_file
# pip install nose!!!

import os
from nose.tools import nottest, assert_equal
import unittest
from HGT_modules.parsenodes import parse_NCBI_nodes_tab_file


# INPUT DATA LOCATION
INPUT = os.path.join("tests", "inputs")



def test_parse_NCBI_nodes_tab_file():
    "test parse_NCBI_nodes_tab_file 1 "
    test_dict = parse_NCBI_nodes_tab_file(os.path.join("tests",
                                                       "inputs"))
    print(test_dict)
    assert_equal(test_dict,
                 {'1': '1', '2': '131567', '6': '335928', '7': '6',
                  '9': '32199', '10': '1706371', '11': '1707',
                  '13': '203488', '14': '13', '16': '32011',
                  '17': '16', '18': '213421', '19': '18',
                  '20': '76892', '21': '20', '22': '267890',
                  '23': '22', '24': '22', '25': '22', '27': '49928',
                  '28': '49928', '29': '28221', '31': '80811',
                  '32': '31', '33': '32', '34': '32', '35': '32',
                  '38': '47', '39': '80811', '40': '39', '41': '40',
                  '42': '39', '43': '42', '44': '39', '45': '44', '47': '39', '48': '47', '49': '80812', '50': '49', '51': '50', '52': '50', '53': '224463', '54': '53', '55': '49', '56': '39643', '57': '2649095', '59': '481', '60': '2627922', '61': '59', '62': '59', '63': '59', '64': '189773', '65': '64', '68': '32033', '69': '68', '71': '481', '72': '71', '75': '76892', '78': '2648921', '81': '45401', '82': '2619925', '83': '81', '84': '81', '85': '69657', '86': '85', '87': '2630699', '88': '224471', '89': '88', '93': '433', '94': '93', '96': '90627', '97': '96', '99': '335928', '100': '99', '101': '89373', '102': '52959', '103': '101', '104': '68288', '105': '89373', '106': '105', '107': '89373', '108': '107', '109': '41294', '110': '279', '112': '203683', '113': '1914233', '114': '113', '117': '2639138', '118': '126', '119': '1649490', '120': '1649480', '122': '1649453', '123': '126', '124': '265487', '125': '123', '126': '112', '127': '1763524', '128': '127', '131': '82117', '132': '131', '133': '31993', '134': '133', '136': '203692', '137': '136', '138': '1643685', '139': '64895', '140': '138', '141': '138', '142': '138', '143': '138', '144': '138', '145': '2649934', '146': '137', '147': '146', '148': '1911556', '149': '146', '150': '146', '151': '2035349', '152': '157', '154': '146', '156': '157', '157': '137', '158': '157', '159': '29521','160': '157', '161': '160', '162': '157', '163': '157', '164': '157', '165': '157', '166': '2638727', '167': '157', '168': '160', '170': '1643688', '171': '170', '172': '171', '173': '171', '174': '171', '176': '173', '178': '2633828', '179': '189779', '180': '655606', '181': '2629551', '183': '32205', '185': '38780', '187': '1499392', '188': '13134', '189': '660514', '190': '187', '191': '41295', '192':'191', '193': '191', '194': '72294', '195': '194', '196': '194', '197': '194', '198': '194', '199': '194', '200': '194', '201': '194', '202': '194', '203': '194', '204': '194', '205': '2593542', '206': '194', '207': '194', '209': '72293', '210': '209', '211': '2593540', '212': '209', '213': '209', '214': '209', '215': '209', '216': '209', '217': '209', '218': '2593540', '222': '506', '223': '222', '224':'222', '226': '72275', '227': '53246', '228': '53246', '232': '2614992', '234': '118882', '235': '234', '236': '234', '237': '49546', '238': '308865', '239': '196869', '240': '196869', '241': '196869', '242': '196869', '244': '162291', '245': '237', '246': '59732', '247': '59734', '249': '296051', '250': '59732', '251': '83612', '252': '2745'})

